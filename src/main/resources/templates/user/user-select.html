<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>사용자 선택 · AI Career Advisor</title>

    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            crossorigin="anonymous">

    <style>
        body {
            background-color: #f8f9fa;
        }

        .user-layout {
            min-height: 100vh;
            padding-top: 40px;
            padding-bottom: 40px;
        }

        .user-card {
            background-color: #ffffff;
            border-radius: 0.75rem;
            box-shadow: 0 0.125rem 0.5rem rgba(0, 0, 0, 0.05);
            padding: 24px;
            margin-bottom: 24px;
        }

        .current-user-badge {
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
<div class="container user-layout">

    <!-- 헤더 영역 -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-1">사용자 선택</h2>
            <p class="text-muted mb-0">
                프로필 작성 전에, 먼저 시스템을 사용할 사용자를 선택하거나 새로 등록합니다.
            </p>
        </div>

        <div class="text-end" th:if="${currentUserId != null}">
            <div class="current-user-badge badge bg-primary-subtle text-primary">
                현재 선택된 사용자:
                <span th:text="${currentUserName}">홍길동</span>
            </div>
            <form th:action="@{/user/clear}" method="post" class="mt-2">
                <button type="submit" class="btn btn-sm btn-outline-secondary">
                    선택 해제
                </button>
            </form>
        </div>
    </div>

    <div class="row g-4">

        <!-- 좌측: 기존 사용자 리스트 -->
        <div class="col-lg-7">
            <div class="user-card">
                <div class="d-flex justify-content-between mb-3">
                    <h5 class="mb-0">기존 사용자 목록</h5>
                </div>

                <div th:if="${#lists.isEmpty(userList)}">
                    <p class="text-muted mb-0">
                        아직 등록된 사용자가 없습니다. 우측에서 새 사용자를 등록해 주세요.
                    </p>
                </div>

                <div th:if="${!#lists.isEmpty(userList)}">
                    <div class="table-responsive">
                        <table class="table table-sm align-middle mb-0">
                            <thead class="table-light">
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">이름</th>
                                <th scope="col">이메일</th>
                                <th scope="col">구분</th>
                                <th scope="col" class="text-end">선택</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="user, stat : ${userList}">
                                <td th:text="${stat.count}">1</td>
                                <td th:text="${user.displayName}">홍길동</td>
                                <td th:text="${user.email}">test@example.com</td>
                                <td th:text="${user.userGroup}">ADULT</td>
                                <td class="text-end">
                                    <form th:action="@{/user/select}" method="post" class="d-inline">
                                        <input type="hidden" name="userId"
                                               th:value="${user.userId}"/>
                                        <button type="submit"
                                                class="btn btn-sm btn-outline-primary">
                                            선택
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>

        <!-- 우측: 신규 사용자 등록 -->
        <div class="col-lg-5">
            <div class="user-card">
                <h5 class="mb-3">신규 사용자 등록</h5>

                <form th:action="@{/user/create}"
                      th:object="${userCreateForm}"
                      method="post"
                      class="needs-validation"
                      novalidate>

                    <div class="mb-3">
                        <label class="form-label" for="displayName">이름</label>
                        <input type="text"
                               class="form-control"
                               id="displayName"
                               th:field="*{displayName}"
                               placeholder="이름 또는 닉네임을 입력하세요"
                               required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label" for="email">이메일</label>
                        <input type="email"
                               class="form-control"
                               id="email"
                               th:field="*{email}"
                               placeholder="이메일을 입력하세요"
                               required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label d-block">사용자 구분</label>

                        <div class="form-check form-check-inline">
                            <input class="form-check-input"
                                   type="radio"
                                   th:field="*{userGroup}"
                                   id="userGroupAdult"
                                   value="ADULT"
                                   checked>
                            <label class="form-check-label" for="userGroupAdult">
                                성인 (구직자/직장인)
                            </label>
                        </div>

                        <div class="form-check form-check-inline">
                            <input class="form-check-input"
                                   type="radio"
                                   th:field="*{userGroup}"
                                   id="userGroupYouth"
                                   value="YOUTH">
                            <label class="form-check-label" for="userGroupYouth">
                                청소년 (중·고·대학생)
                            </label>
                        </div>
                    </div>

                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary">
                            사용자 생성 및 선택
                        </button>
                    </div>

                    <!-- 추후 검증/에러 메시지 영역 -->
                </form>
            </div>
        </div>

    </div>
</div>

<script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>

</body>
</html>
