<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>(주)우리인재개발원 - AI 진로 서비스 대시보드</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
</head>
<body>
    <!-- 
        ============================================
        메인 컨테이너: 사이드바 + 메인 컨텐츠 영역
        ============================================
    -->
    <div class="container-fluid">
        <div class="row">
            <!-- 
                ============================================
                좌측 사이드바 영역
                - 로고 및 주요 메뉴 네비게이션
                - 각 메뉴는 클릭 시 해당 페이지로 이동
                - 백엔드: 각 메뉴 클릭 시 라우팅 처리 필요
                ============================================
            -->
            <nav class="col-md-2 d-md-block bg-light sidebar border-end" style="min-height: 100vh;">
                <div class="position-sticky pt-3">
                    <!-- 로고 영역 -->
                    <div class="px-3 mb-4">
                        <h4 class="text-primary fw-bold">Konnect</h4>
                        <small class="text-muted">AI가 추천하는 진로</small>
                    </div>
                    
                    <!-- 메뉴 리스트 -->
                    <ul class="nav flex-column">
                        <!-- 대시보드 메뉴 (현재 활성화 상태) -->
                        <li class="nav-item">
                            <a class="nav-link active" href="/dashboard">
                                <i class="bi bi-grid-fill me-2"></i>
                                대시보드
                            </a>
                        </li>
                        
                        <!-- 내 프로필 메뉴 -->
                        <!-- 백엔드: /profile 라우트로 사용자 프로필 페이지 연결 -->
                        <li class="nav-item">
                            <a class="nav-link" href="/profile">
                                <i class="bi bi-person-fill me-2"></i>
                                내 프로필
                            </a>
                        </li>
                        
                        <!-- 커리어 분석 메뉴 -->
                        <!-- 백엔드: /career-analysis 라우트로 AI 분석 페이지 연결 -->
                        <li class="nav-item">
                            <a class="nav-link" href="/career-analysis">
                                <i class="bi bi-bar-chart-fill me-2"></i>
                                커리어 분석
                            </a>
                        </li>
                        
                        <!-- 목표 관리 메뉴 -->
                        <!-- 백엔드: /goals 라우트로 목표 설정/관리 페이지 연결 -->
                        <li class="nav-item">
                            <a class="nav-link" href="/goals">
                                <i class="bi bi-flag-fill me-2"></i>
                                목표 관리
                            </a>
                        </li>
                        
                        <!-- 자기소개서 메뉴 -->
                        <!-- 백엔드: /cover-letter 라우트로 자기소개서 작성 페이지 연결 -->
                        <li class="nav-item">
                            <a class="nav-link" href="/cover-letter">
                                <i class="bi bi-file-text-fill me-2"></i>
                                자기소개서
                            </a>
                        </li>
                        
                        <!-- 직업 탐색 메뉴 -->
                        <!-- 백엔드: /job-search 라우트로 직업 검색 페이지 연결 -->
                        <li class="nav-item">
                            <a class="nav-link" href="/job-search">
                                <i class="bi bi-search me-2"></i>
                                직업 탐색
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- 
                ============================================
                메인 컨텐츠 영역
                ============================================
            -->
            <main class="col-md-10 ms-sm-auto px-md-4">
                <!-- 
                    ============================================
                    상단 헤더: 포인트 표시 및 충전 버튼
                    - 백엔드: 사용자 세션에서 포인트 정보 가져오기
                    ============================================
                -->
                <div class="d-flex justify-content-between align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <div></div>
                    <div class="d-flex align-items-center gap-3">
                        <!-- 현재 포인트 표시 -->
                        <!-- 백엔드: GET /api/user/points - 사용자의 현재 포인트 조회 -->
                        <div class="d-flex align-items-center">
                            <i class="bi bi-coin text-warning me-2"></i>
                            <span class="fw-bold">800 포인트</span>
                        </div>
                        
                        <!-- 포인트 충전 버튼 -->
                        <!-- 백엔드: POST /api/payment/charge - 포인트 충전 페이지로 이동 -->
                        <button class="btn btn-warning btn-sm">
                            포인트 충전
                        </button>
                        
                        <!-- 알림 아이콘 -->
                        <button class="btn btn-light btn-sm">
                            <i class="bi bi-bell"></i>
                        </button>
                        
                        <!-- 사용자 프로필 아이콘 -->
                        <!-- 백엔드: 사용자 프로필 이미지 URL 동적 바인딩 -->
                        <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center" 
                             style="width: 40px; height: 40px;">
                            <i class="bi bi-person-fill"></i>
                        </div>
                    </div>
                </div>

                <!-- 
                    ============================================
                    환영 메시지 섹션
                    - 백엔드: 사용자 이름을 세션에서 가져와 동적 표시
                    ============================================
                -->
                <div class="mb-4">
                    <!-- 백엔드: 템플릿 엔진을 통해 사용자 이름 주입 (예: {{ user.name }}) -->
                    <h2 class="fw-bold mb-1">안녕하세요, Kim (White_Snake)boohwan님</h2>
                    <p class="text-muted mb-4">오늘도 커리어 성장을 위한 한 걸음을 시작해보세요.</p>
                    
                    <!-- 현재 보유 포인트 표시 (모바일 대응) -->
                    <div class="alert alert-warning d-flex align-items-center">
                        <i class="bi bi-coin me-2"></i>
                        <span>보유 포인트: <strong>800개</strong></span>
                    </div>
                </div>

                <!-- 
                    ============================================
                    주요 기능 카드 섹션 (4개의 메인 기능)
                    ============================================
                -->
                <div class="row g-4 mb-4">
                    <!-- 
                        프로필 카드
                        - 백엔드: GET /api/profile/completeness - 프로필 완성도 계산
                    -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card h-100 shadow-sm">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="rounded-circle bg-primary bg-opacity-10 p-3 me-3">
                                        <i class="bi bi-person-fill text-primary fs-4"></i>
                                    </div>
                                    <div>
                                        <h5 class="card-title mb-0">프로필</h5>
                                        <small class="text-muted">내 정보 관리</small>
                                    </div>
                                </div>
                                <!-- 백엔드: 프로필 완성도 퍼센테이지 동적 표시 -->
                                <a href="/profile/complete" class="btn btn-outline-primary btn-sm w-100">
                                    5개 프로필
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- 
                        AI 분석 카드
                        - 백엔드: GET /api/analysis/count - 분석 횟수 조회
                    -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card h-100 shadow-sm">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="rounded-circle bg-success bg-opacity-10 p-3 me-3">
                                        <i class="bi bi-bar-chart-line-fill text-success fs-4"></i>
                                    </div>
                                    <div>
                                        <h5 class="card-title mb-0">AI 분석</h5>
                                        <small class="text-muted">커리어 분석</small>
                                    </div>
                                </div>
                                <!-- 백엔드: 분석 횟수 동적 표시 -->
                                <a href="/analysis" class="btn btn-outline-success btn-sm w-100">
                                    1개 분석
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- 
                        Kompass 카드 (목표 설정 기능)
                        - 백엔드: GET /api/kompass/count - 설정된 목표 개수 조회
                    -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card h-100 shadow-sm">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="rounded-circle bg-warning bg-opacity-10 p-3 me-3">
                                        <i class="bi bi-compass-fill text-warning fs-4"></i>
                                    </div>
                                    <div>
                                        <h5 class="card-title mb-0">Kompass</h5>
                                        <small class="text-muted">목표 관리</small>
                                    </div>
                                </div>
                                <!-- 백엔드: 목표 개수 동적 표시 -->
                                <a href="/kompass" class="btn btn-outline-warning btn-sm w-100">
                                    2개 목표
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- 
                        자기소개서 카드
                        - 백엔드: GET /api/cover-letter/count - 작성된 자기소개서 개수 조회
                    -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card h-100 shadow-sm">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="rounded-circle bg-info bg-opacity-10 p-3 me-3">
                                        <i class="bi bi-file-text-fill text-info fs-4"></i>
                                    </div>
                                    <div>
                                        <h5 class="card-title mb-0">자기소개서</h5>
                                        <small class="text-muted">양식이 작성</small>
                                    </div>
                                </div>
                                <!-- 백엔드: 자기소개서 개수 동적 표시 -->
                                <a href="/cover-letter" class="btn btn-outline-info btn-sm w-100">
                                    작성하기
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 
                    ============================================
                    하단 기능 섹션 (2열 레이아웃)
                    ============================================
                -->
                <div class="row g-4">
                    <!-- 
                        ============================================
                        좌측: Kompass 목표 및 AI 커리어 분석
                        ============================================
                    -->
                    <div class="col-lg-6">
                        <!-- 
                            Kompass 목표 설정 카드
                            - 백엔드: POST /api/kompass/ticket - 목표 티켓 등록
                        -->
                        <div class="card shadow-sm mb-4">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-compass text-primary me-2 fs-5"></i>
                                        <h5 class="mb-0">Kompass 목표</h5>
                                    </div>
                                    <!-- 백엔드: /kompass/detail 페이지로 이동 -->
                                    <a href="/kompass/detail" class="text-primary text-decoration-none">
                                        전체보기 <i class="bi bi-chevron-right"></i>
                                    </a>
                                </div>
                                
                                <p class="text-muted small mb-3">목표를 향한 여정을 관리해보세요</p>
                                
                                <!-- 목표 티켓 등록 버튼 1 -->
                                <!-- 백엔드: POST /api/kompass/ticket - 목표 데이터 전송 -->
                                <button class="btn btn-outline-primary w-100 mb-2" onclick="handleTicketSubmit(1)">
                                    <i class="bi bi-calendar-plus me-2"></i>
                                    오늘의 목표 설정
                                </button>
                                
                                <!-- 목표 티켓 등록 버튼 2 -->
                                <button class="btn btn-outline-primary w-100 mb-3" onclick="handleTicketSubmit(2)">
                                    <i class="bi bi-calendar-plus me-2"></i>
                                    오늘의 목표 설정
                                </button>
                                
                                <!-- 목표 진행 상태 표시 -->
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                                        <span>성장한 목표</span>
                                    </div>
                                    <span class="badge bg-success">2개</span>
                                </div>
                                
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-hourglass-split text-warning me-2"></i>
                                        <span>활성 프로젝트</span>
                                    </div>
                                    <span class="badge bg-warning text-dark">5개</span>
                                </div>
                            </div>
                        </div>

                        <!-- 
                            AI 커리어 분석 카드
                            - 백엔드: POST /api/analysis/create - 새로운 분석 생성
                        -->
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-robot text-success me-2 fs-5"></i>
                                        <h5 class="mb-0">AI 커리어 분석</h5>
                                    </div>
                                    <!-- 백엔드: /analysis/detail 페이지로 이동 -->
                                    <a href="/analysis/detail" class="text-success text-decoration-none">
                                        전체보기 <i class="bi bi-chevron-right"></i>
                                    </a>
                                </div>
                                
                                <p class="text-muted small mb-3">AI가 분석한 나의 커리어 인사이트</p>
                                
                                <!-- 분석 완료 알림 -->
                                <div class="alert alert-success mb-3" role="alert">
                                    <i class="bi bi-check-circle-fill me-2"></i>
                                    1개의 커리어 분석이 완료되었습니다.
                                </div>
                                
                                <!-- 새로운 분석 시작 버튼 -->
                                <!-- 백엔드: POST /api/analysis/create - 분석 요청 생성 -->
                                <button class="btn btn-success w-100" onclick="handleAnalysisStart()">
                                    분석 결과 보기
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 
                        ============================================
                        우측: 프로필 진행률 및 자기소개서
                        ============================================
                    -->
                    <div class="col-lg-6">
                        <!-- 
                            프로필 진행 카드
                            - 백엔드: GET /api/profile/progress - 프로필 완성도 조회
                        -->
                        <div class="card shadow-sm mb-4">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-person-circle text-primary me-2 fs-5"></i>
                                        <h5 class="mb-0">프로필 진행</h5>
                                    </div>
                                    <!-- 백엔드: /profile/complete 페이지로 이동 -->
                                    <a href="/profile/complete" class="text-primary text-decoration-none">
                                        수정하기 <i class="bi bi-chevron-right"></i>
                                    </a>
                                </div>
                                
                                <p class="text-muted small mb-3">프로필 완성도</p>
                                
                                <!-- 프로그레스 바 -->
                                <!-- 백엔드: 프로필 완성도 퍼센테이지를 동적으로 계산하여 표시 -->
                                <div class="mb-3">
                                    <div class="d-flex justify-content-between mb-1">
                                        <span class="text-muted small">프로필 완성도</span>
                                        <span class="fw-bold text-primary">작성중</span>
                                    </div>
                                    <div class="progress" style="height: 10px;">
                                        <div class="progress-bar bg-primary" role="progressbar" 
                                             style="width: 60%" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100">
                                        </div>
                                    </div>
                                    <small class="text-muted">프로필 완성되면 더 심화된 분석받으실 수 있습니다. 분석이 완료되면 알림이 갈 것입니다.</small>
                                </div>
                            </div>
                        </div>

                        <!-- 
                            자기소개서 작성 카드
                            - 백엔드: POST /api/cover-letter/create - 새 자기소개서 생성
                        -->
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-file-earmark-text text-info me-2 fs-5"></i>
                                        <h5 class="mb-0">자기소개서</h5>
                                    </div>
                                    <!-- 백엔드: /cover-letter/list 페이지로 이동 -->
                                    <a href="/cover-letter/list" class="text-info text-decoration-none">
                                        전체보기 <i class="bi bi-chevron-right"></i>
                                    </a>
                                </div>
                                
                                <p class="text-muted small mb-3">AI가 도와주는 자기소개서 작성을 시작해보세요.</p>
                                
                                <!-- 자기소개서 작성 버튼 -->
                                <!-- 백엔드: POST /api/cover-letter/create - 100포인트 차감 후 작성 페이지 이동 -->
                                <button class="btn btn-info w-100" onclick="handleCoverLetterCreate()">
                                    <i class="bi bi-pencil-square me-2"></i>
                                    자기소개서 작성 (100 포인트)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- 
        ============================================
        백엔드 연동 JavaScript 함수들
        - 실제 구현 시 Ajax/Fetch API로 백엔드와 통신
        ============================================
    -->
    <script>
        /**
         * Kompass 목표 티켓 제출 함수
         * 백엔드: POST /api/kompass/ticket
         * 
         * @param {number} ticketNumber - 티켓 번호 (1 or 2)
         * 
         * Request Body 예시:
         * {
         *   "user_id": "current_user_id",
         *   "goal_title": "오늘의 목표",
         *   "goal_description": "사용자 입력 내용",
         *   "deadline": "2025-12-31"
         * }
         * 
         * Response 예시:
         * {
         *   "success": true,
         *   "ticket_id": 12345,
         *   "message": "목표가 성공적으로 등록되었습니다."
         * }
         */
        function handleTicketSubmit(ticketNumber) {
            // TODO: 모달 또는 페이지로 이동하여 목표 입력 받기
            // TODO: 입력받은 데이터를 백엔드로 전송
            console.log(`Kompass 티켓 ${ticketNumber} 제출 - 백엔드 POST /api/kompass/ticket`);
            
            // 예시: Fetch API 사용
            /*
            fetch('/api/kompass/ticket', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    ticket_number: ticketNumber,
                    goal_title: '사용자 입력 제목',
                    goal_description: '사용자 입력 설명'
                })
            })
            .then(response => response.json())
            .then(data => {
                alert('목표가 등록되었습니다!');
                location.reload(); // 페이지 새로고침
            })
            .catch(error => console.error('Error:', error));
            */
            
            alert(`티켓 ${ticketNumber} 등록 기능 - 백엔드 연동 필요`);
        }

        /**
         * AI 커리어 분석 시작 함수
         * 백엔드: POST /api/analysis/create
         * 
         * Request Body 예시:
         * {
         *   "user_id": "current_user_id",
         *   "analysis_type": "career_path"
         * }
         * 
         * Response 예시:
         * {
         *   "success": true,
         *   "analysis_id": 789,
         *   "status": "processing",
         *   "estimated_time": "5 minutes"
         * }
         */
        function handleAnalysisStart() {
            console.log('AI 분석 시작 - 백엔드 POST /api/analysis/create');
            
            // TODO: 백엔드로 분석 요청 전송
            // TODO: 분석 진행 상태 페이지로 이동
            /*
            fetch('/api/analysis/create', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    user_id: 'current_user_id'
                })
            })
            .then(response => response.json())
            .then(data => {
                window.location.href = '/analysis/detail/' + data.analysis_id;
            })
            .catch(error => console.error('Error:', error));
            */
            
            alert('AI 분석 시작 기능 - 백엔드 연동 필요');
        }

        /**
         * 자기소개서 작성 시작 함수
         * 백엔드: POST /api/cover-letter/create
         * 
         * 포인트 차감 로직 포함:
         * 1. 사용자 포인트 확인 (최소 100포인트 필요)
         * 2. 포인트 차감 처리
         * 3. 자기소개서 작성 페이지로 이동
         * 
         * Request Body 예시:
         * {
         *   "user_id": "current_user_id",
         *   "cost": 100
         * }
         * 
         * Response 예시:
         * {
         *   "success": true,
         *   "cover_letter_id": 456,
         *   "remaining_points": 700
         * }
         */
        function handleCoverLetterCreate() {
            console.log('자기소개서 작성 - 백엔드 POST /api/cover-letter/create');
            
            // TODO: 포인트 확인 후 차감
            // TODO: 자기소개서 작성 페이지로 이동
            /*
            fetch('/api/cover-letter/create', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    user_id: 'current_user_id',
                    cost: 100
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    window.location.href = '/cover-letter/edit/' + data.cover_letter_id;
                } else {
                    alert('포인트가 부족합니다.');
                }
            })
            .catch(error => console.error('Error:', error));
            */
            
            if (confirm('100 포인트를 사용하여 자기소개서를 작성하시겠습니까?')) {
                alert('자기소개서 작성 기능 - 백엔드 연동 필요');
            }
        }

        /**
         * 페이지 로드 시 초기화 함수
         * 백엔드: GET /api/dashboard/init
         * 
         * 대시보드 초기 데이터 로드:
         * - 사용자 포인트
         * - 프로필 완성도
         * - 목표 개수
         * - 분석 개수
         * - 자기소개서 개수
         * 
         * Response 예시:
         * {
         *   "user": {
         *     "name": "Kim (White_Snake)boohwan",
         *     "points": 800,
         *     "profile_image": "/images/user/profile.jpg"
         *   },
         *   "dashboard": {
         *     "profile_completeness": 60,
         *     "analysis_count": 1,
         *     "goal_count": 2,
         *     "cover_letter_count": 0
         *   }
         * }
         */
        document.addEventListener('DOMContentLoaded', function() {
            console.log('대시보드 초기화 - 백엔드 GET /api/dashboard/init');
            
            // TODO: 백엔드에서 대시보드 초기 데이터 가져오기
            /*
            fetch('/api/dashboard/init')
                .then(response => response.json())
                .then(data => {
                    // 사용자 정보 업데이트
                    updateUserInfo(data.user);
                    // 대시보드 카드 업데이트
                    updateDashboardCards(data.dashboard);
                })
                .catch(error => console.error('Error:', error));
            */
        });
    </script>
</body>
</html>